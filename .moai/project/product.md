# Tally Node - 제품 개요

## 제품 설명

**Tally Node**는 방송 및 영상 제작 환경을 위한 전문 무선 Tally 시스템입니다. LoRa 장거리 무선 통신 기술을 활용하여 비디오 스위처와 카메라 운영자 간의 실시간 Tally 정보를 전송합니다.

### Tally란?

Tally는 방송 및 라이브 영상 제작에서 카메라 운영자에게 현재 카메라가 "방송 중(Program)"인지 "다음 순서(Preview)"인지를 시각적으로 알려주는 시스템입니다. 이를 통해 카메라맨, 조명 감독, 탤레프롬프터 운영자 등 스태프가 자신의 역할을 정확히 수행할 수 있습니다.

## 핵심 기능

### 1. 이중 모드 운영

| 모드 | 설명 | 주요 기능 |
|------|------|----------|
| **TX Mode** | 스위처 연결 및 Tally 정보 수집 | 비디오 스위처 연결, LoRa 송신, 웹 설정 서버 |
| **RX Mode** | Tally 정보 수신 및 표시 | LoRa 수신, OLED 디스플레이, LED 표시 |

### 2. 다중 스위처 프로토콜 지원

- **Blackmagic ATEM**: UDP 기반 프로토콜 (포트 9910)
- **vMix**: TCP 기반 프로토콜 (포트 8099)
- **OBS Studio**: WebSocket 기반 프로토콜 (포트 4455, 개발 중)

### 3. LoRa 무선 통신

- 주파수 대역: 923MHz (한국)
- 통신 거리: 최대 수km (환경에 따라 달라짐)
- 저전력 운영: 배터리로 장시간 사용 가능
- 암호화 통신: 라이선스 기반 통신 보안

### 4. 웹 기반 설정 인터페이스

- 내장 웹 서버로 Wi-Fi/Ethernet 연결 시 자동 구동
- 반응형 UI (모바일/데스크톱 지원)
- 실시간 연결 상태 모니터링
- 스위처 설정 관리 (Primary/Secondary)

### 5. 하드웨어 기능

- **OLED 디스플레이**: Tally 상태, 배터리, 신호 강도 표시
- **WS2812 LED**: Program(빨강)/Preview(초록) 시각 표시
- **배터리 모니터링**: 잔량 표시 및 저전량 경고
- **풀업 버튼**: 메뉴 네비게이션

### 6. TX 모드 Tally 정보 표시

- **실시간 모니터링**: TX 모드에서 현재 Tally 상태를 실시간으로 표시
- **채널별 상태**: 모든 카메라 채널의 Program/Preview 상태를 한눈에 확인
- **웹 인터페이스**: 웹 UI를 통해 Tally 정보 원격 확인

### 7. 라이선스 관리 시스템

- **라이선스 키 보호**: 라이선스 키 가리기/보기 기능으로 보안 강화
- **제품 인증**: 정품 라이선스 검증 시스템
- **암호화 통신**: 라이선스 기반 LoRa 통신 암호화

### 8. 성능 최적화 (최신 업데이트)

#### RX 모드 우선순위 최적화

- **실시간 Tally 수신 보장**: LoRa 수신 태스크 우선순위를 최우선으로 상향
- **지연 최소화**: Tally 정보 수신 후 즉시 표시되도록 처리 파이프라인 최적화
- **네트워크 스택 최적화**: RX 모드에서 네트워크 스택 버퍼 최적화로 메모리 효율 개선

#### Event Bus 우선순위 상향

- **빠른 상태 전파**: RX 모드에서 Event Bus 우선순위 8로 동작
- **실시간 동기화**: Tally 상태 변경 시 모든 구성 요소로 즉시 전파
- **응답성 개선**: 사용자 입력 및 상태 변경에 대한 시스템 반응 속도 향상

## 타겟 사용자

### 1. 주요 사용자

- **방송국 엔지니어**: 스튜디오 및 현장 중계 시스템 구축
- **영상 제작사**: 이벤트, 콘서트, 스포츠 중계
- **교회/교육기관**: 예배, 강의, 행사 라이브 스트리밍
- **유튜버/크리에이터**: 소규모 스튜디오 운영

### 2. 사용 시나리오

| 상황 | 설명 |
|------|------|
| **스튜디오 방송** | 다카메라 환경에서 각 카메라맨에게 현재 온에어 여부 전달 |
| **야외 중계** | 케이블 설치가 어려운 대규모 행사장에서 무선 Tally 운영 |
| **원격 제작** | 분산된 카메라 위치에 유선 Tally 설치가 곤란한 경우 |
| **모바일 스튜디오** | 신속한 설치/철수가 필요한 임시 스튜디오 |

## 주요 사용 사례

### Use Case 1: 다카메라 스포츠 중계

```
스위처(vMix) --(이더넷)--> TX 모드 Tally Node
                                 |
                             (LoRa, 2km)
                                 |
     +----------+----------+-----+-----+
     |          |          |           |
  RX Node #1  RX Node #2  RX Node #3  RX Node #4
  (카메라 1)  (카메라 2)  (카메라 3)  (카메라 4)
```

### Use Case 2: 교회 예배 라이브 스트리밍

- ATEM Mini로 3-4개의 카메라 운영
- 각 카메라맨에게 RX 장치 배포
- 무선으로 케이블 없는 깔끔한 환경 구성

### Use Case 3: 이중 스위처 백업

- Primary: ATEM (메인 스위처)
- Secondary: vMix (백업 스위처)
- TX 모드가 두 스위처를 동시에 감시
- 장애 발생 시 자동으로 백업 스위처의 Tally 정보 사용

## 경쟁 우위

### 1. 무료/오픈소스

- 상용 Tally 시스템은 카메라당 수십~수백만 원
- Tally Node는 하드웨어 비용만으로 구축 가능

### 2. LoRa 장거리 통신

- 기존 Bluetooth/WiFi Tally는 수십m에 불과
- LoRa는 최대 수km 통신 가능

### 3. 다중 프로토콜 지원

- 여러 스위처 브랜드 지원 (ATEM, vMix, OBS)
- 하드웨어 교체 없이 소프트웨어 업데이트만으로 새 프로토콜 추가 가능

### 4. 웹 기반 설정

- 별도의 설정 앱 설치 불필요
- 웹브라우저만으로 모든 설정 가능

## 제약 사항

### 1. 하드웨어 요구사항

- EoRa-S3 보드 (ESP32-S3 기반)
- LoRa 모듈 (SX1262)
- OLED 디스플레이
- WS2812 LED

### 2. 네트워크 요구사항

- TX 모드: 스위처와 동일한 네트워크 (WiFi 또는 Ethernet)
- RX 모드: 네트워크 연결 불필요 (LoRa로만 통신)

### 3. 라이선스

- 일부 고급 기능은 라이선스 키가 필요할 수 있음

## 라이선스 및 저작권

본 프로젝트의 라이선스 정보는 프로젝트 저장소의 LICENSE 파일을 참조하십시오.
