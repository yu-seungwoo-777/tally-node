# 구현 계획: 자동 문서 생성 시스템

**SPEC ID**: SPEC-DOCS-AUTO-001
**생성일**: 2026-01-19
**상태**: Planned

---

## 개요

Tally Node 프로젝트의 소스 코드에서 자동으로 기술 문서를 생성하는 시스템을 구축합니다. C/C++ 주석 파싱, API 문서 생성, 컴포넌트 설명 추출을 자동화하여 문서화 부담을 줄이고 최신 상태를 유지합니다.

---

## 마일스톤

### 1단계: 기초 분석 (우선순위: 높음)

- 기존 소스 코드 주석 스타일 분석
- 문서 생성 도구 선정 (Doxygen, Sphinx, 또는 커스텀)
- 문서 구조 템플릿 설계
- 프로토타입 구현

**완료 기준**:
- 주석 파싱 프로토타입 동작
- 기본 Markdown 출력 확인

### 2단계: 파서 구현 (우선순위: 높음)

- C/C++ 주석 파서 구현
- Doxygen 태그 지원
- 함수/클래스/구조체 메타데이터 추출
- 5계층 컴포넌트 분류 로직

**완료 기준**:
- 주요 컴포넌트 주석 파싱 가능
- JSON 또는 구조화된 데이터 출력

### 3단계: 문서 생성기 구현 (우선순위: 중간)

- Markdown 템플릿 엔진 구현
- API 문서 생성 모듈
- 컴포넌트 문서 생성 모듈
- 크로스레퍼런스 생성

**완료 기준**:
- 함수/클래스별 문서 생성
- 계층 구조 문서 생성

### 4단계: 자동화 통합 (우선순위: 중간)

- Git hook 연동
- 파일 시스템 와처 구현
- 변경 감지 및 재생성 트리거
- CI/CD 파이프라인 통합

**완료 기준**:
- 코드 커밋 시 자동 문서 갱신
- 변경 로그 생성

### 5단계: 기존 문서 통합 (우선순위: 낮음)

- product.md, structure.md, tech.md 파싱
- 중복 콘텐츠 병합 로직
- 통합 문서 생성
- 충돌 해결 전략

**완료 기준**:
- 기존 문서와 자동 생성 문서 통합
- 일관된 문서 구조

### 6단계: 품질 검증 (우선순위: 낮음)

- 링크 검증기 구현
- 누락 문서 감지
- 스타일 가이드 준수 검사
- 문서 품질 리포트

**완료 기준**:
- 자동 품질 검사 가능
- 수정 제안 생성

---

## 기술 접근 방식

### 도구 선정

**옵션 A: Doxygen 기반**
- 장점: 산업 표준, C/C++ 최적화
- 단점: XML 출력 후 후처리 필요
- 추천: 대규모 프로젝트 적합

**옵션 B: 커스텀 파서**
- 장점: 프로젝트 특화, 유연함
- 단점: 개발 및 유지보수 부담
- 추천: 특수 요구사항 있을 때

**옵션 C: 하이브리드**
- Doxygen으로 파싱 + 커스텀 후처리
- 장점: 안정성 + 유연성
- 추천: 균형 잡힌 접근

### 아키텍처

```
┌─────────────────────────────────────────┐
│          소스 코드 (.cpp, .h)           │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│        주석 파서 (Doxygen/Custom)       │
│  - Doxygen 태그 파싱                    │
│  - 메타데이터 추출                      │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│          중간 데이터 (JSON)             │
│  - 함수 정보                             │
│  - 클래스 정보                           │
│  - 컴포넌트 정보                         │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│         문서 생성기 (Template)          │
│  - API 문서                              │
│  - 컴포넌트 문서                         │
│  - 아키텍처 문서                         │
└──────────────┬──────────────────────────┘
               │
               ▼
┌─────────────────────────────────────────┐
│          Markdown 문서 출력             │
│  - docs/api/functions.md                │
│  - docs/components/                     │
│  - docs/architecture.md                 │
└─────────────────────────────────────────┘
```

### 주요 기술 스택

- **파싱**: Doxygen 또는 libclang
- **템플릿**: Jinja2 (Python) 또는 Handlebars (Node.js)
- **자동화**: Git hooks, inotify (Linux), FSEvents (macOS)
- **검증**: Custom link checker, Markdown linter

---

## 위험 및 대응 계획

### 위험 1: 주석 스타일 불일치

**확률**: 높음
**영향**: 중간
**대응**:
- 주석 가이드라인 수립
- 기존 코드 일괄 변환 스크립트
- Lint 규칙 추가

### 위험 2: 복잡한 로직 설명 한계

**확률**: 중간
**영향**: 중간
**대응**:
- 자동 생성 + 수동 보완 하이브리드
- TODO 주석으로 보완 필요 표시
- 복잡한 로직은 별도 설명 문서 작성

### 위험 3: 성능 저하

**확률**: 낮음
**영향**: 낮음
**대응**:
- 증분 문서 생성 (변경된 파일만)
- 캐싱 전략
- 병렬 처리

### 위험 4: 도구 의존성

**확률**: 중간
**영향**: 높음
**대응**:
- 다중 도구 지원 (Doxygen, Sphinx)
- 컨테이너화 (Docker)
- 버전 고정

---

## 다음 단계

1. **기술 검토**: Doxygen vs 커스텀 파서 결정
2. **프로토타입**: 간단한 파서 구현 및 테스트
3. **가이드라인**: 주석 스타일 가이드라인 수립
4. **구현**: 1단계부터 순차적 개발

---

## 참고 자료

- Doxygen 공식 문서: https://www.doxygen.nl/
- ESP-IDF 코딩 스타일 가이드
- Markdown 가이드: CommonMark 표준
