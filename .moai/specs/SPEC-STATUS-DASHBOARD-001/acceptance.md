# 수용 기준 (Acceptance Criteria)

## 개요 (Overview)

본 문서는 SPEC-STATUS-DASHBOARD-001의 수용 기준을 정의합니다. Tally 정보와 연결 상태를 표시하는 하이브리드 페이지의 기능 요구사항을 검증하기 위한 Given-When-Then 형식의 테스트 시나리오를 포함합니다.

## 품질 게이트 (Quality Gates)

### TRUST 5 준수

- **Tested**: 단위 테스트 85%+ 커버리지, 모든 주요 경로 테스트됨
- **Readable**: 명확한 함수명, 코멘트, 일관된 코딩 스타일
- **Unified**: 기존 코드 스타일과 일관성, ESP-IDF 코딩 표준 준수
- **Secured**: 외부 입력 검증, 버퍼 오버플로우 방지
- **Trackable**: Git 커밋 메시지, SPEC 참조 포함

### 수동 테스트 요구사항

임베디드 디스플레이 시스템의 특성상 자동화된 테스트는 제한적입니다. 다음 수동 테스트 시나리오를 통해 기능을 검증합니다.

## 기능적 수용 기준 (Functional Acceptance Criteria)

### TC-001: 첫 페이지 렌더링 - 4-Line 하이브리드 레이아웃

**Given**: TX 모드 장치가 부팅되고 첫 페이지(1/6)가 표시됨
**When**: 사용자가 디스플레이를 확인함
**Then**:
- 헤더 좌측에 "DASHBOARD" 텍스트가 표시됨 (x=4, y=10)
- 헤더 중앙에 페이지 표시 "1/6"이 표시됨 (x=55, y=10)
- 헤더 우측에 배터리 아이콘이 표시됨 (x=105, y=3)
- Line 1 (y=14): PGM 정보가 표시됨 ("PGM: 1,2,3,4" 형식)
- Line 2 (y=25): PVW 정보가 표시됨 ("PVW: 5" 형식)
- Line 3 (y=36): AP, WiFi, ETH 상태가 표시됨
- Line 4 (y=47): SINGLE/DUAL 모드와 스위처 상태가 표시됨
- 모든 텍스트가 128x64 화면 내에 잘리지 않고 표시됨
- IP 주소가 어디에도 표시되지 않음

### TC-002: Tally 정보 표시 - 정상 케이스

**Given**: PGM 채널 1,2,3이 활성화되고 PVW 채널 4가 활성화됨
**When**: Tally 상태가 업데이트됨
**Then**:
- "PGM: 1,2,3" 또는 "P: 1,2,3" 텍스트가 표시됨
- "PVW: 4" 또는 "V: 4" 텍스트가 표시됨
- 채널 리스트가 올바르게 표시됨

### TC-003: Tally 정보 표시 - 긴 채널 리스트

**Given**: PGM 채널 1,2,3,4,5가 활성화됨
**When**: Tally 상태가 업데이트됨
**Then**:
- 최대 4개 채널만 표시됨 (예: "PGM: 1,2,3,4")
- 또는 축약형이 사용됨 (예: "P:1,2,3,4")
- 텍스트가 화면을 넘치지 않음

### TC-004: Line 3 상태 표시 - 모두 연결됨

**Given**: AP가 활성화되고, WiFi STA가 연결되고, Ethernet이 LINK UP 상태임
**When**: 네트워크 상태가 업데이트됨
**Then**:
- Line 3에 "AP:[ON]  WiFi:[✓]  ETH:[✓]" 텍스트가 표시됨
- **IP 주소가 표시되지 않음**

### TC-005: AP 활성화/비활성화 상태 표시

**Given**: WiFi AP가 활성화됨
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "AP:[ON]" 텍스트가 표시됨
- **AP IP 주소가 표시되지 않음**

**Given**: WiFi AP가 비활성화됨
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "AP:[---]" 텍스트가 표시됨 (strike-through 또는 대시)

### TC-006: WiFi STA 연결 상태 표시

**Given**: WiFi STA가 네트워크에 연결됨
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "WiFi:[✓]" 텍스트가 표시됨
- IP 주소가 표시되지 않음

**Given**: WiFi STA가 네트워크에 연결되지 않음
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "WiFi:[✗]" 텍스트가 표시됨

**Given**: WiFi 하드웨어가 미감지됨
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "WiFi:[---]" 텍스트가 표시됨

### TC-007: Ethernet LINK UP/DOWN 상태 표시

**Given**: Ethernet 케이블이 연결되고 LINK UP 상태임
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "ETH:[✓]" 텍스트가 표시됨
- **IP 주소가 표시되지 않음**

**Given**: Ethernet 케이블이 연결되지 않고 LINK DOWN 상태임
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "ETH:[✗]" 텍스트가 표시됨

**Given**: Ethernet 하드웨어가 미감지됨
**When**: 네트워크 상태가 업데이트됨
**Then**:
- "ETH:[---]" 텍스트가 표시됨

### TC-008: Line 4 Single 모드 상태 표시

**Given**: Single 모드이고 ATEM 스위처가 연결됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "SINGLE  ATEM:[✓]" 텍스트가 표시됨
- 스위처 타입이 올바르게 표시됨

**Given**: Single 모드이고 OBS 스위처가 연결 안 됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "SINGLE  OBS:[✗]" 텍스트가 표시됨

**Given**: Single 모드이고 vMix 스위처가 연결됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "SINGLE  vMix:[✓]" 텍스트가 표시됨

### TC-009: Line 4 Dual 모드 상태 표시

**Given**: Dual 모드이고 ATEM1이 연결되고 ATEM2가 연결 안 됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "DUAL  ATEM1:[✓]  ATEM2:[✗]" 텍스트가 표시됨
- 두 스위처 상태가 모두 표시됨

**Given**: Dual 모드이고 OBS1과 vMix2가 모두 연결됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "DUAL  OBS1:[✓]  vMix2:[✓]" 텍스트가 표시됨
- 각 스위처 타입이 올바르게 표시됨

### TC-010: 듀얼 모드 전환 시 Line 4 변경

**Given**: Single 모드에서 "SINGLE  ATEM:[✓]"가 표시됨
**When**: 사용자가 듀얼 모드를 활성화함
**Then**:
- Line 4가 즉시 "DUAL  ATEM1:[✓]  ATEM2:[✗]"로 변경됨
- 두 스위처 상태가 모두 표시됨

**Given**: Dual 모드에서 두 스위처 상태가 표시됨
**When**: 사용자가 듀얼 모드를 비활성화함
**Then**:
- Line 4가 즉시 "SINGLE  ATEM1:[✓]"로 변경됨
- S1 상태만 표시됨

### TC-013: 배터리 레벨 표시

**Given**: 배터리 레벨이 75%임
**When**: 배터리 상태가 업데이트됨
**Then**:
- 헤더의 배터리 아이콘이 레벨 3(충분)로 표시됨
- 배터리 아이콘이 우측 상단에 위치함

### TC-014: 페이지 전환 동작

**Given**: 사용자가 첫 페이지(1/6)를 보고 있음
**When**: 사용자가 페이지 전환 버튼을 누름
**Then**:
- 페이지가 2페이지(Switcher 정보)로 전환됨
- 페이지 표시가 "2/6"으로 변경됨
- 하이브리드 대시보드가 숨겨지고 스위처 정보 페이지가 표시됨

### TC-015: 헤더 "DASHBOARD" 텍스트 표시

**Given**: 첫 페이지가 표시됨
**When**: 헤더 영역을 확인함
**Then**:
- "DASHBOARD" 텍스트가 헤더 좌측(x=4, y=10)에 표시됨
- 페이지 번호가 중앙(x=55, y=10)에 표시됨
- 배터리 아이콘이 우측(x=105, y=3)에 표시됨
- 헤더 형식: "DASHBOARD          1/6 [BAT]"

### TC-011: 실시간 상태 업데이트 - Line 1 PGM

**Given**: 사용자가 첫 페이지를 보고 있음
**When**: PGM 채널이 변경됨 (1,2,3 → 4,5,6)
**Then**:
- 1초 이내에 Line 1이 업데이트됨
- "PGM: 4,5,6"으로 변경됨

### TC-012: 실시간 상태 업데이트 - Line 2 PVW

**Given**: 사용자가 첫 페이지를 보고 있음
**When**: PVW 채널이 변경됨 (5 → 7,8)
**Then**:
- 1초 이내에 Line 2가 업데이트됨
- "PVW: 7,8"로 변경됨

### TC-013: 실시간 상태 업데이트 - Line 3 네트워크

**Given**: 사용자가 첫 페이지를 보고 있음
**When**: WiFi STA가 연결됨
**Then**:
- 1초 이내에 Line 3의 WiFi 상태가 "WiFi:[✗]"에서 "WiFi:[✓]"로 변경됨
- IP 주소는 표시되지 않음

**Given**: 사용자가 첫 페이지를 보고 있음
**When**: Ethernet이 LINK DOWN에서 LINK UP으로 변경됨
**Then**:
- 1초 이내에 Line 3의 ETH 상태가 "ETH:[✗]"에서 "ETH:[✓]"로 변경됨

**Given**: 사용자가 첫 페이지를 보고 있음
**When**: AP가 비활성화됨
**Then**:
- 1초 이내에 Line 3의 AP 상태가 "AP:[ON]"에서 "AP:[---]"로 변경됨

### TC-014: 실시간 상태 업데이트 - Line 4 스위처

**Given**: 사용자가 첫 페이지를 보고 있음 (Single 모드)
**When**: ATEM 스위처가 연결됨
**Then**:
- 1초 이내에 Line 4가 "SINGLE  ATEM:[✗]"에서 "SINGLE  ATEM:[✓]"로 변경됨

**Given**: 사용자가 첫 페이지를 보고 있음 (Dual 모드)
**When**: vMix2가 연결됨
**Then**:
- 1초 이내에 Line 4의 vMix2 상태가 "vMix2:[✗]"에서 "vMix2:[✓]"로 변경됨

## 비기능적 수용 기준 (Non-Functional Acceptance Criteria)

### TC-101: 렌더링 성능

**Given**: 하이브리드 대시보드 페이지가 표시됨
**When**: 페이지가 렌더링됨
**Then**:
- 전체 페이지 렌더링이 100ms 이내에 완료됨
- 사용자에게 지연이 느껴지지 않음

### TC-102: 메모리 사용

**Given**: 하이브리드 대시보드 데이터가 할당됨
**When**: 메모리 사용량이 측정됨
**Then**:
- hybrid_dashboard_data_t 구조체가 256 바이트 이내임
- 추가적인 동적 메모리 할당이 없음
- 스택 사용량이 안전적 범위 내임

### TC-103: 폰트 및 레이아웃 일관성

**Given**: 모든 정보가 표시됨
**When**: 텍스트 렌더링을 확인함
**Then**:
- 모든 텍스트가 profont11_mf 폰트를 사용함
- 모든 라벨이 11px 간격으로 배치됨
- x=4px 패딩이 준수됨

### TC-104: 아이콘 시각적 품질

**Given**: 체크마크 및 엑스마크 아이콘이 표시됨
**When**: 아이콘을 시각적으로 검사함
**Then**:
- 아이콘이 8x8 픽셀 크기임
- 기존 배터리/신호 아이콘과 스타일이 일관됨
- 128x64 디스플레이에서 명확하게 식별 가능함

### TC-101: 렌더링 성능

**Given**: 하이브리드 대시보드 페이지가 표시됨
**When**: 페이지가 렌더링됨
**Then**:
- 전체 페이지 렌더링이 100ms 이내에 완료됨
- 사용자에게 지연이 느껴지지 않음

### TC-102: 메모리 사용

**Given**: 하이브리드 대시보드 데이터가 할당됨
**When**: 메모리 사용량이 측정됨
**Then**:
- hybrid_dashboard_data_t 구조체가 256 바이트 이내임
- 추가적인 동적 메모리 할당이 없음
- 스택 사용량이 안전적 범위 내임

### TC-103: 폰트 및 레이아웃 일관성

**Given**: 모든 정보가 표시됨
**When**: 텍스트 렌더링을 확인함
**Then**:
- 모든 텍스트가 profont11_mf 폰트를 사용함
- 모든 라인이 11px 간격으로 배치됨 (y=14, 25, 36, 47)
- x=4px 패딩이 준수됨

### TC-104: 아이콘 시각적 품질

**Given**: 체크마크, 엑스마크, 대시 아이콘이 표시됨
**When**: 아이콘을 시각적으로 검사함
**Then**:
- 아이콘이 8x8 픽셀 크기임
- 기존 배터리/신호 아이콘과 스타일이 일관됨
- 128x64 디스플레이에서 명확하게 식별 가능함
- "[ON]", "[✓]", "[✗]", "[---]" 상태가 명확히 구별됨

### TC-105: 4-Line 레이아웃 화면 경계 조건

**Given**: 가장 긴 텍스트 조합이 표시됨
**When**: "PGM: 1,2,3,4,5,6"이 Line 1에 렌더링됨
**Then**:
- 텍스트가 화면 우측 경계(x=128)를 넘지 않음
- 텍스트가 잘리지 않음
- Line 1, 2, 3, 4가 서로 겹치지 않음

**Given**: Line 3에 모든 상태가 표시됨
**When**: "AP:[ON]  WiFi:[✓]  ETH:[✓]"가 렌더링됨
**Then**:
- 텍스트가 화면 경계를 넘지 않음
- 각 상태가 명확히 구별됨

**Given**: Dual 모드에서 Line 4가 표시됨
**When**: "DUAL  ATEM1:[✓]  ATEM2:[✗]"가 렌더링됨
**Then**:
- 텍스트가 화면 경계를 넘지 않음
- 두 스위처 상태가 명확히 구별됨

### TC-106: IP 주소 미표시 검증

**Given**: 모든 네트워크 인터페이스가 연결됨
**When**: 하이브리드 대시보드가 렌더링됨
**Then**:
- 어느 위치에도 IP 주소가 표시되지 않음
- "192.168.1.100"과 같은 IP 패턴이 없음

### TC-107: 제목 라인 미표시 검증

**Given**: 첫 페이지가 표시됨
**When**: 페이지 레이아웃을 확인함
**Then**:
- "STATUS DASHBOARD" 제목 라인이 없음
- 헤더 바로 다음 Tally 정보가 표시됨

### TC-108: 이벤트 핸들러 안정성

**Given**: 여러 Tally/네트워크/스위처 상태가 동시에 변경됨
**When**: 이벤트 핸들러가 호출됨
**Then**:
- 렌더링 중복이 발생하지 않음
- 모든 상태 변경이 올바르게 반영됨
- 이벤트 핸들러가 태스크 스택을 오버플로우하지 않음

### TC-109: 회귀 테스트

**Given**: 기존 페이지(2-6)가 존재함
**When**: 페이지 전환을 수행함
**Then**:
- Page 2: Switcher 정보가 정상적으로 표시됨
- Page 3: AP 설정이 정상적으로 표시됨 (IP 포함)
- Page 4: WiFi 설정이 정상적으로 표시됨 (IP 포함)
- Page 5: Ethernet 설정이 정상적으로 표시됨 (IP 포함)
- Page 6: 시스템 정보가 정상적으로 표시됨
- 기존 기능에 어떠한 회귀도 없음

## 엣지 케이스 테스트 (Edge Case Testing)

### TC-201: 모든 연결이 안 됨 + Tally 없음

**Given**: AP가 비활성화되고, WiFi STA 연결 안 되고, Ethernet LINK DOWN이고, 스위처 연결 안 됨
**And**: 활성화된 Tally 채널 없음
**When**: 하이브리드 대시보드가 렌더링됨
**Then**:
- Line 1: "PGM: -" 또는 "PGM: (없음)"이 표시됨
- Line 2: "PVW: -" 또는 "PVW: (없음)"이 표시됨
- Line 3: "AP:[---]  WiFi:[✗]  ETH:[✗]"이 표시됨
- Line 4: "SINGLE  NONE:[✗]" 또는 "DUAL  NONE1:[✗]  NONE2:[✗]"이 표시됨
- 화면이 여전히 읽기 쉽고 organized됨

### TC-202: 모든 연결이 됨 + 최대 Tally

**Given**: AP 활성화, WiFi STA 연결됨, Ethernet LINK UP, 스위처 연결됨
**And**: PGM 6개 채널, PVW 6개 채널 활성화
**When**: 하이브리드 대시보드가 렌더링됨
**Then**:
- Line 1: "PGM: 1,2,3,4,5,6"이 표시됨
- Line 2: "PVW: 1,2,3,4,5,6"이 표시됨
- Line 3: "AP:[ON]  WiFi:[✓]  ETH:[✓]"이 표시됨
- Line 4: "SINGLE  ATEM:[✓]" 또는 "DUAL  ATEM1:[✓]  ATEM2:[✓]"이 표시됨
- 텍스트가 화면을 넘치지 않음
- IP 주소는 표시되지 않음

### TC-203: 듀얼 모드 전환

**Given**: Single 모드에서 "SINGLE  ATEM:[✓]"가 표시됨
**When**: 사용자가 듀얼 모드를 활성화함
**Then**:
- Line 4가 즉시 "DUAL  ATEM1:[✓]  NONE2:[---]"로 변경됨
- 다른 정보가 가려지지 않음

### TC-204: 빠른 상태 변경

**Given**: Tally 상태가 1초 내에 여러 번 변경됨
**When**: 각 변경이 이벤트로 전달됨
**Then**:
- 마지막 상태만 화면에 표시됨
- 렌더링 깜빡임이 없음
- 이벤트가 손실되지 않음

### TC-205: 다양한 스위처 타입 표시

**Given**: ATEM 스위처가 연결됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "SINGLE  ATEM:[✓]"가 표시됨

**Given**: OBS 스위처가 연결됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "SINGLE  OBS:[✓]"가 표시됨

**Given**: vMix 스위처가 연결됨
**When**: 스위처 상태가 업데이트됨
**Then**:
- Line 4에 "SINGLE  vMix:[✓]"가 표시됨

### TC-206: 하드웨어 미감지 상태

**Given**: Ethernet 하드웨어가 장착되지 않음
**When**: 네트워크 상태가 업데이트됨
**Then**:
- Line 3에 "ETH:[---]"가 표시됨
- 다른 상태는 정상 표시됨

## 정의 완료 (Definition of Done)

### 필수 조건 (Must Have)

- [x] 모든 기능적 수용 기준(TC-001 ~ TC-014) 통과
- [x] 모든 비기능적 수용 기준(TC-101 ~ TC-106) 통과
- [x] 엣지 케이스 테스트(TC-201 ~ TC-206) 통과
- [x] 코드가 TRUST 5 프레임워크를 준수함
- [x] Git 커밋이 SPEC-STATUS-DASHBOARD-001 참조를 포함함
- [x] 회귀 테스트 통과 (기존 페이지 2-6 정상 동작)
- [x] 4-Line 레이아웃이 올바르게 구현됨 검증
- [x] IP 주소가 첫 페이지에 표시되지 않음 검증
- [x] AP 상태가 [ON]/[---]로 올바르게 표시됨 검증
- [x] WiFi/ETH 상태가 [✓]/[✗]/[---]로 올바르게 표시됨 검증
- [x] 스위처 타입이 올바르게 표시됨 검증 (ATEM, OBS, vMix)
- [x] SINGLE/DUAL 모드가 올바르게 표시됨 검증

### 선택적 조건 (Should Have)

- [ ] 자동화된 단위 테스트 85%+ 커버리지
- [ ] 성능 프로파일링 데이터 수집
- [ ] 사용자 가이드 문서 업데이트

### 배포 후 검증 (Post-Deployment)

- [ ] 실제 하드웨어에서 24시간 안정성 테스트
- [ ] 다양한 네트워크 환경에서 필드 테스트
- [ ] 사용자 피드백 수집 및 개선

## 테스트 실행 가이드

### 하드웨어 요구사항

- ESP32-S3 기반 Tally Node 장치
- SSD1306 128x64 OLED 디스플레이
- USB 전원 또는 배터리
- WiFi 네트워크 액세스 포인트
- Ethernet 케이블 (선택적)
- ATEM 스위처 (선택적)

### 테스트 절차

1. **기본 설정**: 장치를 전원에 연결하고 부팅
2. **기본 테스트**: TC-001부터 TC-017까지 순차적으로 실행
3. **비기능 테스트**: TC-101부터 TC-109까지 실행
4. **엣지 케이스**: TC-201부터 TC-205까지 실행
5. **IP 주소 검증**: 모든 테스트에서 IP 주소 미표시 확인
6. **버그 리포팅**: 실패한 테스트 케이스를 기록하고 수정
7. **재테스트**: 모든 테스트가 통과할 때까지 반복

### 테스트 결과 문서화

각 테스트 실행 후 다음을 기록:
- 테스트 케이스 ID
- 실행 날짜/시간
- 결과 (Pass/Fail)
- 실패 시 재현 단계
- 스크린샷 또는 비디오 (가능한 경우)

## 승인 프로세스 (Approval Process)

1. 개발자가 모든 테스트를 실행하고 결과 문서화
2. 코드 리뷰에서 SPEC 요구사항 충족 여부 검증
3. IP 주소 미표시, 제목 미표시, 헤더 "DASHBOARD" 텍스트 표시 검증
4. 정품 하드웨어에서 최종 검증
5. 프로젝트 관리자가 승인
6. 병합(merge) 및 배포
