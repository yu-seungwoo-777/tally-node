# ì•„í‚¤í…ì²˜

**ì‘ì„±ì¼**: 2025-12-23
**ë²„ì „**: 3.0 (5ê³„ì¸µ ì•„í‚¤í…ì²˜)

---

## ê°œìš”

ESP32-S3 (EoRa-S3) ê¸°ë°˜ LoRa í†µì‹  í”„ë¡œì íŠ¸ì˜ 5ê³„ì¸µ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.

---

## ê³„ì¸µ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 01_app (ì•±)                                             â”‚
â”‚ - lora_test: LoRa í…ŒìŠ¤íŠ¸ ì•±                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 02_presentation (í”„ë ˆì  í…Œì´ì…˜)                         â”‚
â”‚ - (ë¹„ì–´ìˆìŒ)                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 03_service (ì„œë¹„ìŠ¤)                                     â”‚
â”‚ - button_poll: ë²„íŠ¼ í´ë§ (ìƒíƒœ ë¨¸ì‹ )                   â”‚
â”‚ - lora_service: LoRa í†µì‹  ì„œë¹„ìŠ¤                       â”‚
â”‚ - network_service: ë„¤íŠ¸ì›Œí¬ í†µí•© ê´€ë¦¬ (ê³„íš)           â”‚
â”‚ - config_service: NVS ì„¤ì • ê´€ë¦¬ (ê³„íš)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 04_driver (ë“œë¼ì´ë²„)                                    â”‚
â”‚ - lora_driver: RadioLib ë˜í¼                           â”‚
â”‚ - wifi_driver: WiFi ì œì–´ (ê³„íš)                        â”‚
â”‚ - ethernet_driver: W5500 Ethernet ì œì–´ (ê³„íš)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 05_hal (í•˜ë“œì›¨ì–´ ì¶”ìƒí™”)                               â”‚
â”‚ - lora_hal: SX1262 í•˜ë“œì›¨ì–´ ì œì–´                        â”‚
â”‚ - wifi_hal: esp_wifi ìº¡ìŠí™” (ê³„íš)                     â”‚
â”‚ - ethernet_hal: W5500 SPI/GPIO (ê³„íš)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 00_common (ê³µí†µ)                                        â”‚
â”‚ - event_bus: ì´ë²¤íŠ¸ ë²„ìŠ¤ ì‹œìŠ¤í…œ                         â”‚
â”‚ - pin_config: EoRa-S3 í•€ ë§µ ì •ì˜ (ê³„íš)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì˜ì¡´ì„± ê·œì¹™

### 1. ì¸ì ‘í•œ ê³„ì¸µë§Œ ì˜ì¡´ (ë ˆì´ì–´ ê±´ë„ˆë›°ê¸° ê¸ˆì§€)

í•˜ìœ„ ê³„ì¸µì€ ë°˜ë“œì‹œ **ì¸ì ‘í•œ ìƒìœ„ ê³„ì¸µ**ì„ í†µí•´ì„œë§Œ ì ‘ê·¼í•´ì•¼ í•©ë‹ˆë‹¤.

```
O ì˜¬ë°”ë¥¸ ì˜ˆ:
01_app â†’ 03_service
03_service â†’ 04_driver
04_driver â†’ 05_hal

X ì˜ëª»ëœ ì˜ˆ (ê±´ë„ˆë›°ê¸°):
01_app â†’ 04_driver  (03_serviceë¥¼ ê±°ì³ì•¼ í•¨)
01_app â†’ 05_hal     (03, 04ë¥¼ ê±°ì³ì•¼ í•¨)
03_service â†’ 00_common  (04, 05ë¥¼ ê±°ì³ì•¼ í•¨)
```

### 2. event_busë¡œ ëŠìŠ¨í•œ ê²°í•© (Loose Coupling)

**event_bus ì—­í• **: ì»´í¬ë„ŒíŠ¸ ê°„ ì§ì ‘ ì˜ì¡´ì„ í”¼í•˜ê³  ëŠìŠ¨í•œ ê²°í•©ì„ ì œê³µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 01_app (lora_test)                                  â”‚
â”‚   - event_bus êµ¬ë… (subscribe)                      â”‚
â”‚   - lora_service ì´ë²¤íŠ¸ ìˆ˜ì‹                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â–²
                       â”‚ event
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 03_service (lora_service)                           â”‚
â”‚   - event_busì— ì´ë²¤íŠ¸ ë°œí–‰ (publish)               â”‚
â”‚   - 01_appê³¼ ì§ì ‘ ì˜ì¡´í•˜ì§€ ì•ŠìŒ                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì‚¬ìš© ì˜ˆì‹œ:**
- í•˜ìœ„ ê³„ì¸µ: `event_bus_publish(EVT_LORA_PACKET_RECEIVED, &data, size);`
- ìƒìœ„ ê³„ì¸µ: `event_bus_subscribe(EVT_LORA_PACKET_RECEIVED, callback);`

---

## ì»´í¬ë„ŒíŠ¸ ìƒì„¸

### 00_common - ê³µí†µ

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì˜ì¡´ì„± | ìƒíƒœ |
|---------|------|--------|------|
| event_bus | ì»´í¬ë„ŒíŠ¸ ê°„ ì´ë²¤íŠ¸ ê¸°ë°˜ í†µì‹  | freertos | âœ… |

### í”„ë¡œì íŠ¸ ì „ì—­ (include/)

| íŒŒì¼ | ì—­í•  | ìƒíƒœ |
|------|------|------|
| PinConfig.h | EoRa-S3 í•€ ë§µ ì •ì˜ | ğŸ”„ ê³„íš |

### 01_app - ì•±

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì˜ì¡´ì„± | ìƒíƒœ |
|---------|------|--------|------|
| lora_test | LoRa í…ŒìŠ¤íŠ¸ ì•± | button_poll, lora_service, event_bus | âœ… |

### 02_presentation - í”„ë ˆì  í…Œì´ì…˜

(ë¹„ì–´ìˆìŒ)

### 03_service - ì„œë¹„ìŠ¤

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì˜ì¡´ì„± | ìƒíƒœ |
|---------|------|--------|------|
| button_poll | ë²„íŠ¼ í´ë§ (ìƒíƒœ ë¨¸ì‹ ) | driver, esp_timer | âœ… |
| lora_service | LoRa í†µì‹  ì„œë¹„ìŠ¤ | lora_driver, event_bus | âœ… |
| network_service | ë„¤íŠ¸ì›Œí¬ í†µí•© ê´€ë¦¬ | wifi_driver, ethernet_driver, config_service | ğŸ”„ ê³„íš |
| config_service | NVS ì„¤ì • ê´€ë¦¬ | nvs_flash | ğŸ”„ ê³„íš |

### 04_driver - ë“œë¼ì´ë²„

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì˜ì¡´ì„± | ìƒíƒœ |
|---------|------|--------|------|
| lora_driver | RadioLib ë˜í¼ | lora_hal, RadioLib | âœ… |
| wifi_driver | WiFi AP+STA ì œì–´ | wifi_hal, pin_config | ğŸ”„ ê³„íš |
| ethernet_driver | W5500 Ethernet ì œì–´ | ethernet_hal, pin_config | ğŸ”„ ê³„íš |

### 05_hal - í•˜ë“œì›¨ì–´ ì¶”ìƒí™”

| ì»´í¬ë„ŒíŠ¸ | ì—­í•  | ì˜ì¡´ì„± | ìƒíƒœ |
|---------|------|--------|------|
| lora_hal | LoRa í•˜ë“œì›¨ì–´ ì œì–´ (SX1262) | driver | âœ… |
| wifi_hal | esp_wifi ìº¡ìŠí™” | esp_wifi, esp_netif | ğŸ”„ ê³„íš |
| ethernet_hal | W5500 SPI/GPIO ì œì–´ | esp_eth, spi_master, gpio | ğŸ”„ ê³„íš |

---

## ì˜ì¡´ì„± ê·¸ë˜í”„

```
lora_test (01_app)
    â”‚
    â”œâ”€â†’ button_poll (03_service)
    â”‚       â””â”€â†’ driver, esp_timer
    â”‚
    â””â”€â†’ lora_service (03_service)
            â””â”€â†’ lora_driver (04_driver)
                    â””â”€â†’ lora_hal (05_hal)
                            â””â”€â†’ driver
            â””â”€â†’ event_bus (00_common)

# ê³„íš (network_service)
network_service (03_service)
    â”‚
    â”œâ”€â†’ wifi_driver (04_driver)
    â”‚       â””â”€â†’ wifi_hal (05_hal)
    â”‚               â””â”€â†’ esp_wifi, esp_netif
    â”‚
    â”œâ”€â†’ ethernet_driver (04_driver)
    â”‚       â””â”€â†’ ethernet_hal (05_hal)
    â”‚               â””â”€â†’ esp_eth, spi_master, gpio
    â”‚
    â”œâ”€â†’ config_service (03_service)
    â”‚       â””â”€â†’ nvs_flash
    â”‚
    â””â”€â†’ event_bus (00_common)

# ê³µí†µ
include/PinConfig.h â†’ ëª¨ë“  ê³„ì¸µì—ì„œ ì‚¬ìš©
```

---

## ë²„íŠ¼ ë™ì‘

| ì•¡ì…˜ | ì‹œê°„ | ë™ì‘ |
|------|------|------|
| ë‹¨ì¼ í´ë¦­ | < 1000ms | "Test" ë©”ì‹œì§€ ì†¡ì‹  |
| ë¡± í”„ë ˆìŠ¤ | â‰¥ 1000ms | í†µê³„ ì¶œë ¥ (ì†¡ì‹ /ìˆ˜ì‹ /RSSI/SNR) |

---

## LoRa ì„¤ì •

| íŒŒë¼ë¯¸í„° | ê°’ |
|---------|-----|
| ì£¼íŒŒìˆ˜ | 923.0 MHz |
| ëŒ€ì—­í­ | 250.0 kHz |
| í™•ì„± ê³„ìˆ˜ | 9 |
| ì½”ë”© ë ˆì´íŠ¸ | 5 |
| ì†¡ì‹  ì „ë ¥ | 22 dBm |
| ë™ê¸° ì›Œë“œ | 0x12 |

---

## í•˜ë“œì›¨ì–´

| í•­ëª© | ê°’ |
|------|-----|
| ë³´ë“œ | EoRa-S3 (ESP32-S3) |
| LoRa ì¹© | SX1262 |
| ë²„íŠ¼ | GPIO_NUM_0 (ë‚´ì¥ BOOT ë²„íŠ¼, Active Low) |

### í•€ ë§µ (include/PinConfig.h)

| ê¸°ëŠ¥ | GPIO | ì„¤ëª… |
|------|------|------|
| LoRa MISO | 3 | SPI2_HOST |
| LoRa MOSI | 6 | SPI2_HOST |
| LoRa SCK | 5 | SPI2_HOST |
| LoRa CS | 7 | Chip Select |
| LoRa DIO1 | 33 | IRQ |
| LoRa BUSY | 34 | Busy |
| LoRa RST | 8 | Reset |
| W5500 MISO | 15 | SPI3_HOST |
| W5500 MOSI | 16 | SPI3_HOST |
| W5500 SCK | 48 | SPI3_HOST |
| W5500 CS | 47 | Chip Select |
| W5500 RST | 12 | Reset |
| LED BOARD | 37 | ë³´ë“œ ë‚´ì¥ LED |
| LED PGM | 38 | Program LED (ë¹¨ê°„ìƒ‰) |
| LED PVW | 39 | Preview LED (ë…¹ìƒ‰) |
| WS2812 | 45 | RGB LED |
| BAT ADC | 1 | ë°°í„°ë¦¬ ì „ì•• |
